import{r as Q,g as j,R as q,_ as O}from"./index-CesDyvRg.js";const z={},E=t=>{let o;const e=new Set,n=(v,h)=>{const c=typeof v=="function"?v(o):v;if(!Object.is(c,o)){const i=o;o=h??(typeof c!="object"||c===null)?c:Object.assign({},o,c),e.forEach(m=>m(o,i))}},s=()=>o,g={setState:n,getState:s,getInitialState:()=>f,subscribe:v=>(e.add(v),()=>e.delete(v)),destroy:()=>{(z?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),e.clear()}},f=o=t(n,s,g);return g},F=t=>t?E(t):E;var $={exports:{}},R={},L={exports:{}},C={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=Q;function H(t,o){return t===o&&(t!==0||1/t===1/o)||t!==t&&o!==o}var k=typeof Object.is=="function"?Object.is:H,U=b.useState,M=b.useEffect,N=b.useLayoutEffect,W=b.useDebugValue;function J(t,o){var e=o(),n=U({inst:{value:e,getSnapshot:o}}),s=n[0].inst,r=n[1];return N(function(){s.value=e,s.getSnapshot=o,_(s)&&r({inst:s})},[t,e,o]),M(function(){return _(s)&&r({inst:s}),t(function(){_(s)&&r({inst:s})})},[t]),W(e),e}function _(t){var o=t.getSnapshot;t=t.value;try{var e=o();return!k(t,e)}catch{return!0}}function G(t,o){return o()}var Y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?G:J;C.useSyncExternalStore=b.useSyncExternalStore!==void 0?b.useSyncExternalStore:Y;L.exports=C;var B=L.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I=Q,K=B;function X(t,o){return t===o&&(t!==0||1/t===1/o)||t!==t&&o!==o}var Z=typeof Object.is=="function"?Object.is:X,V=K.useSyncExternalStore,ee=I.useRef,te=I.useEffect,re=I.useMemo,ne=I.useDebugValue;R.useSyncExternalStoreWithSelector=function(t,o,e,n,s){var r=ee(null);if(r.current===null){var d={hasValue:!1,value:null};r.current=d}else d=r.current;r=re(function(){function g(i){if(!f){if(f=!0,v=i,i=n(i),s!==void 0&&d.hasValue){var m=d.value;if(s(m,i))return h=m}return h=i}if(m=h,Z(v,i))return m;var u=n(i);return s!==void 0&&s(m,u)?(v=i,m):(v=i,h=u)}var f=!1,v,h,c=e===void 0?null:e;return[function(){return g(o())},c===null?void 0:function(){return g(c())}]},[o,e,n,s]);var p=V(t,r[0],r[1]);return te(function(){d.hasValue=!0,d.value=p},[p]),ne(p),p};$.exports=R;var oe=$.exports;const se=j(oe),D={},{useDebugValue:ie}=q,{useSyncExternalStoreWithSelector:ae}=se;let x=!1;const ue=t=>t;function le(t,o=ue,e){(D?"production":void 0)!=="production"&&e&&!x&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),x=!0);const n=ae(t.subscribe,t.getState,t.getServerState||t.getInitialState,o,e);return ie(n),n}const T=t=>{(D?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const o=typeof t=="function"?F(t):t,e=(n,s)=>le(o,n,s);return Object.assign(e,o),e},ce=t=>t?T(t):T,de={};function fe(t,o){let e;try{e=t()}catch{return}return{getItem:s=>{var r;const d=g=>g===null?null:JSON.parse(g,void 0),p=(r=e.getItem(s))!=null?r:null;return p instanceof Promise?p.then(d):d(p)},setItem:(s,r)=>e.setItem(s,JSON.stringify(r,void 0)),removeItem:s=>e.removeItem(s)}}const w=t=>o=>{try{const e=t(o);return e instanceof Promise?e:{then(n){return w(n)(e)},catch(n){return this}}}catch(e){return{then(n){return this},catch(n){return w(n)(e)}}}},me=(t,o)=>(e,n,s)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:l=>l,version:0,merge:(l,S)=>({...S,...l}),...o},d=!1;const p=new Set,g=new Set;let f;try{f=r.getStorage()}catch{}if(!f)return t((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),e(...l)},n,s);const v=w(r.serialize),h=()=>{const l=r.partialize({...n()});let S;const a=v({state:l,version:r.version}).then(y=>f.setItem(r.name,y)).catch(y=>{S=y});if(S)throw S;return a},c=s.setState;s.setState=(l,S)=>{c(l,S),h()};const i=t((...l)=>{e(...l),h()},n,s);let m;const u=()=>{var l;if(!f)return;d=!1,p.forEach(a=>a(n()));const S=((l=r.onRehydrateStorage)==null?void 0:l.call(r,n()))||void 0;return w(f.getItem.bind(f))(r.name).then(a=>{if(a)return r.deserialize(a)}).then(a=>{if(a)if(typeof a.version=="number"&&a.version!==r.version){if(r.migrate)return r.migrate(a.state,a.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return a.state}).then(a=>{var y;return m=r.merge(a,(y=n())!=null?y:i),e(m,!0),h()}).then(()=>{S==null||S(m,void 0),d=!0,g.forEach(a=>a(m))}).catch(a=>{S==null||S(void 0,a)})};return s.persist={setOptions:l=>{r={...r,...l},l.getStorage&&(f=l.getStorage())},clearStorage:()=>{f==null||f.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>u(),hasHydrated:()=>d,onHydrate:l=>(p.add(l),()=>{p.delete(l)}),onFinishHydration:l=>(g.add(l),()=>{g.delete(l)})},u(),m||i},ve=(t,o)=>(e,n,s)=>{let r={storage:fe(()=>localStorage),partialize:u=>u,version:0,merge:(u,l)=>({...l,...u}),...o},d=!1;const p=new Set,g=new Set;let f=r.storage;if(!f)return t((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),e(...u)},n,s);const v=()=>{const u=r.partialize({...n()});return f.setItem(r.name,{state:u,version:r.version})},h=s.setState;s.setState=(u,l)=>{h(u,l),v()};const c=t((...u)=>{e(...u),v()},n,s);s.getInitialState=()=>c;let i;const m=()=>{var u,l;if(!f)return;d=!1,p.forEach(a=>{var y;return a((y=n())!=null?y:c)});const S=((l=r.onRehydrateStorage)==null?void 0:l.call(r,(u=n())!=null?u:c))||void 0;return w(f.getItem.bind(f))(r.name).then(a=>{if(a)if(typeof a.version=="number"&&a.version!==r.version){if(r.migrate)return[!0,r.migrate(a.state,a.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,a.state];return[!1,void 0]}).then(a=>{var y;const[A,P]=a;if(i=r.merge(P,(y=n())!=null?y:c),e(i,!0),A)return v()}).then(()=>{S==null||S(i,void 0),i=n(),d=!0,g.forEach(a=>a(i))}).catch(a=>{S==null||S(void 0,a)})};return s.persist={setOptions:u=>{r={...r,...u},u.storage&&(f=u.storage)},clearStorage:()=>{f==null||f.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>m(),hasHydrated:()=>d,onHydrate:u=>(p.add(u),()=>{p.delete(u)}),onFinishHydration:u=>(g.add(u),()=>{g.delete(u)})},r.skipHydration||m(),i||c},pe=(t,o)=>"getStorage"in o||"serialize"in o||"deserialize"in o?((de?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),me(t,o)):ve(t,o),he=pe,Se=ce()(he((t,o)=>({allQuestions:[],questions:[],currentQuestionIndex:0,currentPhase:null,currentLevel:null,answers:[],isTestStarted:!1,isTestCompleted:!1,result:null,isLoadingQuestions:!1,errorLoadingQuestions:null,startTest:(e,n)=>{const{allQuestions:s}=o();let r=s.filter(d=>d.phase===e);if(e==="spot"&&n&&(r=r.filter(d=>d.level===n)),r.length===0){console.warn(`No questions found for phase: ${e}`+(n?` and level: ${n}`:"")),t({questions:[],currentPhase:e,currentLevel:e==="spot"&&n||null,currentQuestionIndex:0,answers:[],isTestStarted:!1,isTestCompleted:!1,result:null});return}t({questions:r,currentPhase:e,currentLevel:e==="spot"&&n||null,isTestStarted:!0,isTestCompleted:!1,currentQuestionIndex:0,answers:[],result:null})},nextQuestion:()=>{const{currentQuestionIndex:e,questions:n}=o();e<n.length-1&&t({currentQuestionIndex:e+1})},previousQuestion:()=>{const{currentQuestionIndex:e}=o();e>0&&t({currentQuestionIndex:e-1})},answerQuestion:e=>{const{answers:n}=o(),s=n.findIndex(d=>d.questionId===e.questionId);let r;s>=0?(r=[...n],r[s]=e):r=[...n,e],t({answers:r})},completeTest:()=>{const e=o().calculateResult(),n=o().generateShareableCard(e);t({isTestCompleted:!0,result:{...e,shareableCardUrl:n}})},resetTest:()=>t({currentQuestionIndex:0,answers:[],isTestStarted:!1,isTestCompleted:!1,result:null,currentPhase:null,currentLevel:null}),loadQuestions:async()=>{t({isLoadingQuestions:!0,errorLoadingQuestions:null});try{const e=await O(()=>import("./questions-keFSAEso.js"),[]),n=e.default||e;let s;if(n&&Array.isArray(n.questions))s=n.questions;else if(Array.isArray(n))s=n;else throw console.error("Invalid questions.json structure:",n),new Error('Invalid questions.json structure. Expected an object with a "questions" array or an array of questions.');t({allQuestions:s,isLoadingQuestions:!1})}catch(e){console.error("Failed to load questions:",e),t({errorLoadingQuestions:e instanceof Error?e.message:"Unknown error loading questions",isLoadingQuestions:!1})}},calculateResult:()=>{const{answers:e,questions:n}=o(),s=e.reduce((c,i)=>c+i.score,0),r=n.reduce((c,i)=>{if(!i.options||i.options.length===0)return c;const m=Math.max(...i.options.map(u=>u.score||0));return c+(m>0?m:0)},0),d=e.filter(c=>{const i=n.find(m=>m.id===c.questionId);return(i==null?void 0:i.phase)==="spot"}),p=e.filter(c=>{const i=n.find(m=>m.id===c.questionId);return(i==null?void 0:i.phase)==="end"}),g=d.reduce((c,i)=>c+i.score,0),f=p.reduce((c,i)=>c+i.score,0),v=s/r*100;let h="";return v>=80?h="Excellent! You have a strong understanding of how to identify and stop sexualised violence in sport.":v>=60?h="Good awareness! There are still some areas where you can improve your knowledge.":v>=40?h="You have some knowledge, but there's room for significant improvement in recognizing warning signs.":h="This is an important learning opportunity. We encourage you to explore our resources to better understand the signs.",{totalScore:s,maxScore:r,spotScore:g,endScore:f,feedback:h}},generateShareableCard:e=>{const n=Math.round(e.totalScore/e.maxScore*100),s="https://res.cloudinary.com/demo/image/upload",r=`l_text:Inter_60_bold:I%20scored%20${n}%25%20on%20the%20SPOT%20IT%20STOP%20IT%20test`;return`${s}/c_fill,w_1200,h_630,b_rgb:0A1E3F/${r},g_center,y_-50/spot-it-stop-it-card.png`}}),{name:"test-progress",partialize:t=>({answers:t.answers,currentQuestionIndex:t.currentQuestionIndex,isTestStarted:t.isTestStarted,isTestCompleted:t.isTestCompleted,result:t.result})}));export{Se as u};
